@model VwPeriodeListSummary
@{
    ViewData["Title"] = "Periode";
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">
        <strong>Error ! </strong> @TempData["ErrorMessage"]
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span>&times;</span>
        </button>
    </div>
}
<style>

    .date-period {
        width: 420px;
        height: 136px;
        left: 880px;
        top: 549px;
        font-weight: 400;
        font-size: 50px;
        line-height: 60px;
        align-items: center;
        color: #1b6ec2;
    }
    .tab-periode-menu{
        margin-top:50px;
    }

     .riwayat-menu{
        position: relative;
        margin: auto;
        text-align: left;
        height: 100%;
        background-color: white;
        border-radius: 10px;
        border: 5px solid #99b138;
        margin-bottom:20px;
        padding:25px;
     }
    .periode-menu{
        position: relative;
        margin: auto;
        text-align: left;
        height: 300px;
        background-color: white;
        border-radius: 10px;
        border: 5px solid #99b138;
        margin-bottom:20px;
    }
    .periode-menu > div{
        margin:auto;
    }
    #tanggal_name1{
        color: #99b138;
        @*text-align:left !important;*@
    }

    /*------Table styling----*/
     table.dataTable thead>tr>th {
        text-align: center;
        vertical-align:middle;
        background-color:white;
    }

    table.dataTable tbody tr > .dtfc-fixed-left, table.dataTable tbody tr > .dtfc-fixed-right {
        z-index: 0;
        background-color: white;
    }

    table.dataTable thead tr > .dtfc-fixed-left, table.dataTable thead tr > .dtfc-fixed-right, table.dataTable tfoot tr > .dtfc-fixed-left, table.dataTable tfoot tr.odd > .dtfc-fixed-right{
       background-color:white;
  
    }

 table.dataTable tbody tr.odd > .dtfc-fixed-right {
        z-index: 0;
        background-color: #eaeaea;
    }
    .btn-light {
    color: #212529;
    background-color: transparent !important;
    border-color: transparent !important;
}

    table.dataTable tbody th, table.dataTable tbody td {
        padding: 1px !important;
        text-align:center;
    }

    dataTables_scroll {
        font-size:9pt !important;
    }
    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #eaeaea;
}

    .table-striped tbody tr:nth-of-type(even) {
        background-color:#ffff;
    }
</style>

<partial name="_HomeButton" />

<nav class="tab-periode-menu">
    <div class="nav nav-tabs nav-pills nav-justified flex-sm-row" id="nav-tab" role="tablist">
        <a class="nav-item nav-link active" id="nav-periode-tab" data-toggle="tab" href="#nav-periode" role="tab" aria-controls="nav-periode" aria-selected="true">Periode Pelaporan</a>
        <a class="nav-item nav-link" id="nav-riwayat-tab" data-toggle="tab" href="#nav-riwayat" role="tab" aria-controls="nav-riwayat" aria-selected="false">Riwayat Pelaporan</a>
    </div>
</nav>
<form asp-controller="Household" asp-action="Index">
<div class="row periode-menu">
   <div class="col-xl-6">
            <div class="form-group">
                <input asp-for="PeriodeDetail" type="text" class="form-control" id="datepicker" placeholder="Pilih periode" autocomplete="off" />
                @*<span id="tanggal_name">span kiri</span>*@
            </div>
    </div>
    <div class="col-xl-6">
            <div class="form-group">
                <h3 style="text-align:left;">Kamu memilih Periode</h3>
                <span id="tanggal_name1" class="date-period"></span>
            </div>
    </div>
 </div>
<div class="form-group selanjutnya">
        <div class="col text-center">
            <input type="submit" value="Selanjutnya" class="btn btn-success" />
        </div>
 </div>
</form>
<div class="row riwayat-menu">
    <div class="col col-xl-12">
        <table class="table table-striped table-bordered" id="Periode" style="width:100%;">
                <thead>
                    <tr>
                        <th>
                            @Html.DisplayNameFor(model => model.PeriodeId)
                        </th>
                        <th>
                            Periode
                        </th>
                        <th>
                            Emisi Rumah Tangga (KG CO<sup>2</sup>)
                            @*<label>Emisi Rumah Tangga</label></br>
                            <label>(KG CO<sup>2</sup>)</label>*@
                        <th>
                            Emisi Kendaraan (KG CO<sup>2</sup>)
                            @*<label>Emisi Kendaraan</label></br>
                            <label>(KG CO<sup>2</sup>)</label>*@
                        </th>
                        <th>
                            Serapan Karbon (KG CO<sup>2</sup>)
                            @*<label>Serapan Karbon</label></br>
                            <label>(KG CO<sup>2</sup>)</label>*@
                        </th>
                        <th>
                            Total Emisi (KG CO<sup>2</sup>)
                            @*<label>Total Emission</label></br>
                             <label>(KG CO<sup>2</sup>)</label>*@
                        </th>
                        <th>
                            @*@Html.DisplayNameFor(model => model.img)*@
                            Detail
                        </th>
                    </tr>
                </thead>
            </table>
    </div>
</div>


<div class="row riwayat-menu">
    <div class="col col-xl-12">
        <table class="table table-striped table-bordered" id="Periode3" style="width:100%;">
            <!-- Chart Insert-->
            Grafik Emisi Karbon           

            <canvas width="120" height="50"></canvas>
                
            </table>
    </div>
</div>

@section scripts{ 
    <script>
        $(function () {
            $('#datepicker').datepicker({
                format: 'MM-yyyy',
                startView: "months",
                minViewMode: "months",
                autoclose: true,
                orientation: "bottom",
                endDate: "0m" //disable current and next month
                //endDate: "-1m" //disable current and next month
            });
        });

        $(document).ready(function () {
            $('#datepicker').on('change', function () {
                var dateThis = $(this).val();
                $('#tanggal_name1').text(dateThis);
            });
        });
    </script>

    <script type="text/javascript">
        var UrlListVehicle = '@Url.Action("GetListSummary", "Periode")';

        $(document).ready(function () {
            //$('div[id="nav-rumah"]').on('shown.bs.tab', function (e) {
            //    $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();
            //});
         $(".riwayat-menu").hide();
         $("#nav-riwayat-tab").click(function () {
                $(".periode-menu").hide();
                $(".selanjutnya").hide();
                $(".riwayat-menu").fadeIn(700);
        });
        $("#nav-periode-tab").click(function () {
                $(".riwayat-menu").hide();
                $(".periode-menu").fadeIn(700);
                $(".selanjutnya").fadeIn(700);
        });

            $('#Periode').dataTable({
                //scrollX: true,
                order: [8, 'asc', 7, 'asc'],
                ajax: {
                    url: UrlListVehicle,
                    type: 'GET',
                    dataType: 'json',
                    dataSrc: ''
                },
                columnDefs: [
                    { 'targets': [0], 'visible': false, 'searchable': false },
                    //{ 'width': '200px', 'targets': [2], 'orderable': false },
                    { 'width': '70px', 'targets': [6], 'orderable': false },
                    { 'width': '70px', 'targets': [7], 'visible': false },
                    { 'width': '70px', 'targets': [8], 'visible': false }
                ],
                responsive: true,
                columns: [
                    { data: 'periodeId' },//0
                    { data: 'periodeDetail' },//1
                    { data: 'peopleEmission' },//6
                    { data: 'vehicleEmission' },//2
                    { data: 'carbonAbsorption' },//4
                    { data: 'totalEmission' },//3
                    {
                        data: 'id',
                        render: function (data, type, row, meta) {                            
                                return '<a class="btn btn-success col text-center" style="margin-right:5px;" href="/Summary/Index/' + row.periodeId + '"><i class="fa fa-file"></i> Detail</a>'                            
                        } //5
                    },
                    { data: 'month' },//7
                    { data: 'year' },//8

                ],
            });            
        });
    </script>    


    <!-- Chart Script -->

    <script>
        var ApiUrl = '@Url.Action("GetListSummary", "Periode")';

        $(document).ready(function () {
            $.ajax({
                url: ApiUrl,
                method: "GET",
                success: function (data) {
                    console.log(data);
                    var label = [];
                    var value = [];
                    for (var i in data) {
                        label.push(data[i].periodeDetail);
                        value.push(data[i].totalEmission);
                    }
                    var ctx = document.querySelector('canvas').getContext('2d'); //context to get from
                    //var ctx = document.getElementById('userId').getContext('2d');
                    var chart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: label,
                            datasets: [{
                                label: 'Emisi Karbon',
                                //backgroundColor: 'rgb(252, 116, 101)',
                                //borderColor: 'rgb(255, 255, 255)',
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                    'rgba(75, 192, 192, 0.2)',
                                    'rgba(153, 102, 255, 0.2)',
                                    'rgba(255, 159, 64, 0.2)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1,
                                data: value
                            }]
                        },
                        options: {}
                    });
                }
            });

        });
    </script>

}