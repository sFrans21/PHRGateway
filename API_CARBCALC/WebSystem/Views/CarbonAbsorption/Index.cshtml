@model IEnumerable<WebSystem.Models.CarbonAbsorptionViewModel>

@{
    ViewData["Title"] = "Index";
}

<link href="~/bootstrap-datepicker/css/bootstrap-datepicker.css" rel="stylesheet" />
<style>
    table.dataTable thead > tr > th {
        text-align: center;
        vertical-align: middle;
        background-color: white;
    }

    table.dataTable tbody tr > .dtfc-fixed-left, table.dataTable tbody tr > .dtfc-fixed-right {
        z-index: 0;
        background-color: white;
    }

    table.dataTable thead tr > .dtfc-fixed-left, table.dataTable thead tr > .dtfc-fixed-right, table.dataTable tfoot tr > .dtfc-fixed-left, table.dataTable tfoot tr.odd > .dtfc-fixed-right {
        background-color: white;
    }

    table.dataTable tbody tr.odd > .dtfc-fixed-right {
        z-index: 0;
        background-color: #eaeaea;
    }

    .btn-light {
        color: #212529;
        background-color: transparent !important;
        border-color: transparent !important;
    }

    table.dataTable tbody th, table.dataTable tbody td {
        padding: 1px !important;
        text-align: center;
    }

    dataTables_scroll {
        font-size: 9pt !important;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #eaeaea;
    }

    .table-striped tbody tr:nth-of-type(even) {
        background-color: #ffff;
    }
</style>

<partial name="_HomeButton" />

<div class="d-flex justify-content-center pt-2">
    <div class="card text-white bg-danger" style="width: 12rem;">
        <div class="card-body text-center" style="padding: 0.25rem;">
            <a class="btn text-white" asp-controller="Periode" asp-action="Index" title="Ke Halaman Periode"><i class="fa fa-calendar"></i> @ViewBag.periodedetail</a>
        </div>
    </div>
</div>

<div class="text-center" style="padding-top:15px;">
    @*<h2>Hai, @ViewBag.Displayname</h2>*@
    <h3>Hitung emisi serapan karbon kamu</h3>
</div>


<nav>
    <div class="nav nav-tabs nav-pills nav-justified flex-sm-row" id="nav-tab" role="tablist">        
        <a class="nav-item nav-link" asp-controller="Household" asp-action="Index"><img src="/assets/img/home_nav.png" style="width:25px;" /> Tempat Tinggal</a>
        <a class="nav-item nav-link" asp-controller="Vehicle" asp-action="Index"><img src="/assets/img/vehicle_nav.png" style="width:25px;" /> Kendaraan</a>
        <a class="nav-item nav-link active" asp-controller="CarbonAbsorption" asp-action="Index"><img src="/assets/img/Tree_nav.png" style="width:25px;" /> Serapan Karbon</a>
    </div>
</nav>

@*serapan karbon*@
<div class="tab-pane fade show active" id="nav-serapan" role="tabpanel" aria-labelledby="nav-serapan-tab">
    <div class="pt-4">
        <a class="btn btn-success mb-3" asp-controller="CarbonAbsorption" asp-action="Create"><i class="fa fa-plus"></i> Tambah</a>
        <table class="table table-striped table-bordered" id="carbonAbsorption">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.CarbonAbsorptionId)
                    </th>
                    <th>
                        @*@Html.DisplayNameFor(model => model.TreeId)*@
                        Nama Pohon
                    </th>
                    @*<th>
                            Periode

                        </th>*@
                    @*<th>
                            @Html.DisplayNameFor(model => model.UserId)
                            User Id
                        </th>*@
                    <th>
                        @*@Html.DisplayNameFor(model => model.Age)*@
                        Umur
                    </th>
                    <th>
                        @*@Html.DisplayNameFor(model => model.Amount)*@
                        Jumlah
                    </th>
                    <th>
                        @*@Html.DisplayNameFor(model => model.CarbonAbs)*@
                        Serapan Karbon (KG CO<sup>2</sup>)
                    </th>
                    <th>
                        Tanggal
                    </th>
                    <th>Action</th>
                </tr>
            </thead>
        </table>
    </div>
</div>

@section scripts{

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script type="text/javascript">
        var UrlCarbonAbsorption = '@Url.Action("GetList", "CarbonAbsorption")';
        var url = '@Url.Action("Details", "CarbonAbsorption")'


        $(document).ready(function () {
            //$('div[id="nav-rumah"]').on('shown.bs.tab', function (e) {
            //    $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();
            //});

            $('table.table').dataTable({
                order:[0,'desc'],
                ajax: {
                    url: UrlCarbonAbsorption,
                    type: 'GET',
                    dataType: 'json',
                    dataSrc: ''
                },
                columnDefs: [
                    { 'targets': [0], 'visible': false, 'searchable': false },
                    { 'targets': [2], 'visible': false, 'searchable': false },
                    { 'width': '150px', 'targets': [6], 'orderable': false }
                ],
                responsive: true,
                columns: [
                    { data: 'carbonAbsorptionId' },//0
                    { data: 'treeName' },//1
                    //{ data: 'periode' },//2
                    //{ data: 'userId' },//3
                    { data: 'age' },//4
                    { data: 'amount',
                        render: $.fn.dataTable.render.number(',', '.', 0)
                    },//4a
                    {
                        data: 'carbonAbs',
                        render: $.fn.dataTable.render.number(',', '.', 2)
                    },
                    {
                        data: 'createDateString'
                            //    "render": function (data, type, row) {
                            //return moment(data).format('DD MMMM YYYY');
                            //     }
                    },
                    //{ data: 'carbonAbs' },
                    //{ data: 'createDate' }, //5
                    {
                        data: 'id',
                        render: function (data, type, row, meta) {
                            if (row.treeName === 'Total') {
                                return '<p> </p>'
                            }

                            else {

                                  return '<a class="btn btn-light" style="margin-right:5px;" href="' + row.encLink_Edit + '"><i class="fa fa-pencil"></i></a>' +
                                    '<a class="btn btn-light" style="margin-right:5px;" href="' + row.encLink_Details + '" ><i class="fa fa-eye"></i></a>' +
                                    '<a class="btn btn-light" style="margin-right:5px;" onclick="Delete(' + row.carbonAbsorptionId + ')" ><i class="fa fa-trash"></i></a>'
                            //5 

                                //return '<a class="btn btn-light" style="margin-right:5px;" href="/carbonAbsorption/Edit/' + row.carbonAbsorptionId + '"><i class="fa fa-pencil"></i></a>' +
                                //    '<a class="btn btn-light" style="margin-right:5px;" href="/carbonAbsorption/Details/' + row.carbonAbsorptionId + '" ><i class="fa fa-eye"></i></a>' +
                                //    '<a class="btn btn-light" style="margin-right:5px;" onclick="Delete(' + row.carbonAbsorptionId + ')" ><i class="fa fa-trash"></i></a>'
                                ////5
                            }

                        }
                    },
                ],
            });
        });

        $(function () {
        var successMessage = '@TempData["SuccessMessage"]'
        if (successMessage != '')
            alertify.success(successMessage);
        });

        function Delete(id) {
            alertify.confirm('Carbon Calculator', 'Hapus data ?', function () {
                window.location.href = '@Url.Action("Delete", "CarbonAbsorption")/' + id;
            }, null)
        }

        function showInPopup(id) {
            window.location.href = '@Url.Action("Details", "CarbonAbsorption")/' + id;
        }
    </script>
}